{include file="header.phtml"}

{assign var='addDomainParams' value="open: true, iframe: true, transition: 'elastic', width: '800px', height: '480px'"}

<div class="page-content" >

    <div class="page-header" >
        <h1>Domain List</h1>
    </div>
    
    {ViMbAdmin_Messages}

<table id="domain_list_table"  cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered">
    <thead>
        <tr>
            <th>Domain</th>
            <th>Mailboxes</th>
            <th>Aliases</th>
            <th>Active</th>
            <th>Transport</th>
            <th>Backup MX</th>
            <th>Created</th>
            <th>{if $identity.admin.super}<button onclick="$.fn.colorbox({ href:'{genUrl controller='domain' action='edit'}', {$addDomainParams} });">Add Domain</button>{/if}</th>
        </tr>
    </thead>
    <tbody>
{foreach $domains as $oneDomain}
        <tr id="domain_{$oneDomain.id}">
            <td>{$oneDomain.domain}</td>
            <td><a class="ul" href="{genUrl controller='mailbox' action='list' did=$oneDomain.id}">{$oneDomain->countMailboxes()}{if $oneDomain.mailboxes}/{$oneDomain.mailboxes}{/if}</a></td>
            <td><a class="ul" href="{genUrl controller='alias' action='list' did=$oneDomain.id}">{$oneDomain->countAliases( true )}{if $oneDomain.aliases}/{$oneDomain.aliases}{/if}</a></td>
            <td><a id="toggle_active_{$oneDomain.id}" href="#" onclick="toggleActive({$oneDomain.id});">{$oneDomain.active|yesno}</a></td>
            <td>{$oneDomain.transport}</td>
            <td>{$oneDomain.backupmx|yesno}</td>
            <td>{$oneDomain.created}</td>
            <td>
                <a class="btn btn-mini" href="{genUrl controller='log' action='list' did=$oneDomain.id}">Logs</a>
                {if $identity.admin.super}
                    <button  class="btn btn-mini"  onclick="purgeDomain({$oneDomain.id}, '{$oneDomain.domain}');">Purge</button>
                {/if}
                {if $identity.admin.super}
                    <a class="btn btn-mini"  href="{genUrl controller='domain' action='admins' did=$oneDomain.id}">Admins</a>
                {/if}
                <button class="btn btn-mini" onclick="$.fn.colorbox({ href:'{genUrl controller='domain' action='edit' did=$oneDomain.id}', {$addDomainParams} });">Edit</button>
            </td>
        </tr>
{/foreach}
    </tbody>
</table>

<br /><br /><br />

{include file='domain/js/list.js'}

</div>

{include file="footer.phtml"}
