{include file="header.phtml"}

{assign var='addDomainParams' value="open: true, iframe: true, transition: 'elastic', width: '800px', height: '480px'"}

<div class="page-content" >

    <div class="page-header" >

        {if $identity.admin.super}
        <div style="float: right; margin-top: -10px;">
            <div class="btn-toolbar">
            	<span class="btn-group">
        	        <a class="btn" id="modal-dialog-wide_add_domain" href="{genUrl controller='domain' action='edit' modal=true}" title="Add Domain">
            	        <i class="icon-plus"></i>
        	        </a>
            	</span>
        	</div>
    	</div>
    	{/if}

        <h1>Domain List</h1>
    </div>

    {ViMbAdmin_Messages}

<table id="domain_list_table"  cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered">
    <thead>
        <tr>
            <th>Domain</th>
            <th>Mailboxes</th>
            <th>Aliases</th>
            <th>Active</th>
            <th>Transport</th>
            <th>Backup MX</th>
            <th>Created</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
{foreach $domains as $oneDomain}
        <tr id="domain_{$oneDomain.id}">
            <td>{$oneDomain.domain}</td>
            <td><a class="ul" href="{genUrl controller='mailbox' action='list' did=$oneDomain.id}">{$oneDomain->countMailboxes()}{if $oneDomain.mailboxes}/{$oneDomain.mailboxes}{/if}</a></td>
            <td><a class="ul" href="{genUrl controller='alias' action='list' did=$oneDomain.id}">{$oneDomain->countAliases( true )}{if $oneDomain.aliases}/{$oneDomain.aliases}{/if}</a></td>
            <td>
                <div id="throb-toggle-active-{$oneDomain.id}" style="float: right;"></div>
                <span id="toggle-active-{$oneDomain.id}" class="btn btn-mini {if $oneDomain.active}btn-success{else}btn-danger{/if}">{$oneDomain.active|yesno}</span>
            </td>
            <td>{$oneDomain.transport}</td>
            <td>{$oneDomain.backupmx|yesno}</td>
            <td>{$oneDomain.created}</td>
            <td>
                <a class="btn btn-mini" href="{genUrl controller='log' action='list' did=$oneDomain.id}">Logs</a>
                {if $identity.admin.super}
                    <span  class="btn btn-mini"  id="domain-purge-{$oneDomain.id}" ref="{$oneDomain.domain}">Purge</span>
                {/if}
                {if $identity.admin.super}
                    <a class="btn btn-mini"  href="{genUrl controller='domain' action='admins' did=$oneDomain.id}">Admins</a>
                {/if}
                <a class="btn btn-mini" id="modal-dialog-wide_edit_domain_{$oneDomain.id}" href="{genUrl controller='domain' action='edit' did=$oneDomain.id modal=true}">Edit</a>
            </td>
        </tr>
{/foreach}
    </tbody>
</table>

<br /><br /><br />

{include file='domain/js/list.js'}

<div id="purge_dialog" class="modal hide fade">
    <div class="modal-header">
        <a href="#" class="close" data-dismiss="modal">&times;</a>
        <h3>Are you sure?</h3>
    </div>
    <div class="modal-body">
        Are you sure you want to purge
        <em id="purge_domain_name"></em> ?
        <br>
        <br>
        All mailboxes, aliases and logs will be removed.
        <br>
        <br>
    </div>
    <div id="mfooter" class="modal-footer">
        <span class="btn btn-danger" id="purge_dialog_delete">Purge</span>
        <button id="purge_dialog_cancel" class="btn">Cancel</button>
    </div>
</div>

</div>

{include file="footer.phtml"}
